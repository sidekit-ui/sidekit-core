!function(t,e){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t.Mustache={},e(t.Mustache))}(this,function(t){function e(t){return"function"==typeof t}function n(t){return g(t)?"array":typeof t}function r(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(t,e){return null!=t&&"object"==typeof t&&e in t}function o(t,e){return v.call(t,e)}function s(t){return!o(w,t)}function a(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return y[t]})}function u(e,n){function i(){if(w&&!y)for(;v.length;)delete d[v.pop()];else v=[];w=!1,y=!1}function o(t){if("string"==typeof t&&(t=t.split(S,2)),!g(t)||2!==t.length)throw new Error("Invalid tags: "+t);a=new RegExp(r(t[0])+"\\s*"),u=new RegExp("\\s*"+r(t[1])),l=new RegExp("\\s*"+r("}"+t[1]))}if(!e)return[];var a,u,l,p=[],d=[],v=[],w=!1,y=!1;o(n||t.tags);for(var E,T,K,j,P,U,A=new f(e);!A.eos();){if(E=A.pos,K=A.scanUntil(a))for(var C=0,V=K.length;C<V;++C)j=K.charAt(C),s(j)?v.push(d.length):y=!0,d.push(["text",j,E,E+1]),E+=1,"\n"===j&&i();if(!A.scan(a))break;if(w=!0,T=A.scan(b)||"name",A.scan(m),"="===T?(K=A.scanUntil(k),A.scan(k),A.scanUntil(u)):"{"===T?(K=A.scanUntil(l),A.scan(x),A.scanUntil(u),T="&"):K=A.scanUntil(u),!A.scan(u))throw new Error("Unclosed tag at "+A.pos);if(P=[T,K,E,A.pos],d.push(P),"#"===T||"^"===T)p.push(P);else if("/"===T){if(U=p.pop(),!U)throw new Error('Unopened section "'+K+'" at '+E);if(U[1]!==K)throw new Error('Unclosed section "'+U[1]+'" at '+E)}else"name"===T||"{"===T||"&"===T?y=!0:"="===T&&o(K)}if(U=p.pop())throw new Error('Unclosed section "'+U[1]+'" at '+A.pos);return h(c(d))}function c(t){for(var e,n,r=[],i=0,o=t.length;i<o;++i)e=t[i],e&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}function h(t){for(var e,n,r=[],i=r,o=[],s=0,a=t.length;s<a;++s)switch(e=t[s],e[0]){case"#":case"^":i.push(e),o.push(e),i=e[4]=[];break;case"/":n=o.pop(),n[5]=e[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(e)}return r}function f(t){this.string=t,this.tail=t,this.pos=0}function l(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function p(){this.cache={}}var d=Object.prototype.toString,g=Array.isArray||function(t){return"[object Array]"===d.call(t)},v=RegExp.prototype.test,w=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},m=/\s*/,S=/\s+/,k=/\s*=/,x=/\s*\}/,b=/#|\^|\/|>|\{|&|=|!/;f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},f.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},l.prototype.push=function(t){return new l(t,this)},l.prototype.lookup=function(t){var n,r=this.cache;if(r.hasOwnProperty(t))n=r[t];else{for(var o,s,a=this,u=!1;a;){if(t.indexOf(".")>0)for(n=a.view,o=t.split("."),s=0;null!=n&&s<o.length;)s===o.length-1&&(u=i(n,o[s])),n=n[o[s++]];else n=a.view[t],u=i(a.view,t);if(u)break;a=a.parent}r[t]=n}return e(n)&&(n=n.call(this.view)),n},p.prototype.clearCache=function(){this.cache={}},p.prototype.parse=function(t,e){var n=this.cache,r=n[t];return null==r&&(r=n[t]=u(t,e)),r},p.prototype.render=function(t,e,n){var r=this.parse(t),i=e instanceof l?e:new l(e);return this.renderTokens(r,i,n,t)},p.prototype.renderTokens=function(t,e,n,r){for(var i,o,s,a="",u=0,c=t.length;u<c;++u)s=void 0,i=t[u],o=i[0],"#"===o?s=this.renderSection(i,e,n,r):"^"===o?s=this.renderInverted(i,e,n,r):">"===o?s=this.renderPartial(i,e,n,r):"&"===o?s=this.unescapedValue(i,e):"name"===o?s=this.escapedValue(i,e):"text"===o&&(s=this.rawValue(i)),void 0!==s&&(a+=s);return a},p.prototype.renderSection=function(t,n,r,i){function o(t){return s.render(t,n,r)}var s=this,a="",u=n.lookup(t[1]);if(u){if(g(u))for(var c=0,h=u.length;c<h;++c)a+=this.renderTokens(t[4],n.push(u[c]),r,i);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)a+=this.renderTokens(t[4],n.push(u),r,i);else if(e(u)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,i.slice(t[3],t[5]),o),null!=u&&(a+=u)}else a+=this.renderTokens(t[4],n,r,i);return a}},p.prototype.renderInverted=function(t,e,n,r){var i=e.lookup(t[1]);if(!i||g(i)&&0===i.length)return this.renderTokens(t[4],e,n,r)},p.prototype.renderPartial=function(t,n,r){if(r){var i=e(r)?r(t[1]):r[t[1]];return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},p.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},p.prototype.escapedValue=function(e,n){var r=n.lookup(e[1]);if(null!=r)return t.escape(r)},p.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.2.1",t.tags=["{{","}}"];var E=new p;t.clearCache=function(){return E.clearCache()},t.parse=function(t,e){return E.parse(t,e)},t.render=function(t,e,r){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+n(t)+'" was given as the first argument for mustache#render(template, view, partials)');return E.render(t,e,r)},t.to_html=function(n,r,i,o){var s=t.render(n,r,i);return e(o)?void o(s):s},t.escape=a,t.Scanner=f,t.Context=l,t.Writer=p}),function(t,e){function n(){e.expr[":"].hasAttr=e.expr.createPseudo(function(t){var e=new RegExp(t);return function(t){for(var n=t.attributes,r=0;r<n.length;r++)if(e.test(n[r].nodeName))return!0;return!1}})}function r(){e("*:hasAttr(^data-sidekit-.+$)").each(function(){i(this)})}function i(t){for(var n,r,i,s="data-sidekit-",a=0,u=t.attributes.length;a<u;a++)if(n=t.attributes[a],r=n.name.toLowerCase(),0===r.indexOf(s)){if(!window[n.value])throw"Something strange has happened. Widget '"+n.name+"' data not found!";i=r.replace(s,"").toLowerCase(),o.push({id:t.id,data:window[n.value],w:i}),e(t).removeAttr(r)}}var o=[];t.init=function(){n(),r(),this.factory.create(o),o=[]}}(window.SideKit=window.SideKit||{},jQuery);var SideKit=window.SideKit||{};SideKit.factory={},function(t,e){"use strict";function n(r,i){if(r<i.length){var o,s=i[r],a=s.w;t.hasOwnProperty(a)&&(o=t[a],e.when(o.init(s.data)).then(function(){o.run(s.id,s.data),n(++r,i)}))}else i=null}t.create=function(t){var e=0;n(e,t)}}(SideKit.factory,jQuery);var SideKit=window.SideKit||{};SideKit.widget={},function(t,e,n,r){"use strict";t.env="DEV",t.assetsPath=null,t.getStyleSheet=function(t){$d=e.Deferred();var n=document.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href=t,document.getElementsByTagName("head")[0].appendChild(n),$d.resolve(n),$d.promise()},t.getMainSideKitScriptTag=function(){if(document.currentScript)return document.currentScript.src;for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++)if(e[n].getAttribute("data-sidekit"))return t.env=e[n].src.match(/sidekit-core.min.js|sidekit-core.js/)?"PROD":"ENV",e[n];return null},t.getAssetsPath=function(){if(null===this.assetsPath){var t=this.getMainSideKitScriptTag();this.assetsPath=t.getAttribute("data-sidekit")}return this.assetsPath},t.render=function(t,e,i){var o="";if(e!==r&&e.length)try{o=n.to_html(e,i||{})}catch(t){o=t.toString()}t.html(o)}}(SideKit.widget,jQuery,Mustache);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpZGVraXQtdWktY29yZS5taW4uanMiXSwibmFtZXMiOlsiZ2xvYmFsIiwiZmFjdG9yeSIsImV4cG9ydHMiLCJub2RlTmFtZSIsImRlZmluZSIsImFtZCIsIk11c3RhY2hlIiwidGhpcyIsIm11c3RhY2hlIiwiaXNGdW5jdGlvbiIsIm9iamVjdCIsInR5cGVTdHIiLCJvYmoiLCJpc0FycmF5IiwiZXNjYXBlUmVnRXhwIiwic3RyaW5nIiwicmVwbGFjZSIsImhhc1Byb3BlcnR5IiwicHJvcE5hbWUiLCJ0ZXN0UmVnRXhwIiwicmUiLCJyZWdFeHBUZXN0IiwiY2FsbCIsImlzV2hpdGVzcGFjZSIsIm5vblNwYWNlUmUiLCJlc2NhcGVIdG1sIiwiU3RyaW5nIiwicyIsImVudGl0eU1hcCIsInBhcnNlVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInRhZ3MiLCJzdHJpcFNwYWNlIiwiaGFzVGFnIiwibm9uU3BhY2UiLCJzcGFjZXMiLCJsZW5ndGgiLCJ0b2tlbnMiLCJwb3AiLCJjb21waWxlVGFncyIsInRhZ3NUb0NvbXBpbGUiLCJzcGxpdCIsInNwYWNlUmUiLCJFcnJvciIsIm9wZW5pbmdUYWdSZSIsIlJlZ0V4cCIsImNsb3NpbmdUYWdSZSIsImNsb3NpbmdDdXJseVJlIiwic2VjdGlvbnMiLCJzdGFydCIsInR5cGUiLCJ2YWx1ZSIsImNociIsInRva2VuIiwib3BlblNlY3Rpb24iLCJzY2FubmVyIiwiU2Nhbm5lciIsImVvcyIsInBvcyIsInNjYW5VbnRpbCIsImkiLCJ2YWx1ZUxlbmd0aCIsImNoYXJBdCIsInB1c2giLCJzY2FuIiwidGFnUmUiLCJ3aGl0ZVJlIiwiZXF1YWxzUmUiLCJjdXJseVJlIiwibmVzdFRva2VucyIsInNxdWFzaFRva2VucyIsImxhc3RUb2tlbiIsInNxdWFzaGVkVG9rZW5zIiwibnVtVG9rZW5zIiwic2VjdGlvbiIsIm5lc3RlZFRva2VucyIsImNvbGxlY3RvciIsInRhaWwiLCJDb250ZXh0IiwidmlldyIsInBhcmVudENvbnRleHQiLCJjYWNoZSIsIi4iLCJwYXJlbnQiLCJXcml0ZXIiLCJvYmplY3RUb1N0cmluZyIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiQXJyYXkiLCJ0ZXN0IiwiJiIsIjwiLCI+IiwiXCIiLCInIiwiLyIsImAiLCI9IiwibWF0Y2giLCJpbmRleCIsInN1YnN0cmluZyIsInNlYXJjaCIsImxvb2t1cCIsIm5hbWUiLCJoYXNPd25Qcm9wZXJ0eSIsIm5hbWVzIiwiY29udGV4dCIsImxvb2t1cEhpdCIsImluZGV4T2YiLCJjbGVhckNhY2hlIiwicGFyc2UiLCJyZW5kZXIiLCJwYXJ0aWFscyIsInJlbmRlclRva2VucyIsIm9yaWdpbmFsVGVtcGxhdGUiLCJzeW1ib2wiLCJidWZmZXIiLCJ1bmRlZmluZWQiLCJyZW5kZXJTZWN0aW9uIiwicmVuZGVySW52ZXJ0ZWQiLCJyZW5kZXJQYXJ0aWFsIiwidW5lc2NhcGVkVmFsdWUiLCJlc2NhcGVkVmFsdWUiLCJyYXdWYWx1ZSIsInN1YlJlbmRlciIsInNlbGYiLCJqIiwic2xpY2UiLCJlc2NhcGUiLCJ2ZXJzaW9uIiwiZGVmYXVsdFdyaXRlciIsIlR5cGVFcnJvciIsInRvX2h0bWwiLCJzZW5kIiwicmVzdWx0IiwiU2lkZUtpdCIsIiQiLCJpbml0aWFsaXplUGFydGlhbFNlbGVjdG9yRXhwcmVzc2lvbiIsImV4cHIiLCJoYXNBdHRyIiwiY3JlYXRlUHNldWRvIiwicmVnZXgiLCJhdHRycyIsImF0dHJpYnV0ZXMiLCJjb2xsZWN0V2lkZ2V0c0NvbmZpZ3VyYXRpb25EYXRhIiwiZWFjaCIsInBhcnNlV2lkZ2V0RGF0YSIsImVsIiwiYXR0ciIsIndpZGdldCIsInByZWZpeCIsImFMZW4iLCJ0b0xvd2VyQ2FzZSIsIndpbmRvdyIsIndpZGdldHMiLCJpZCIsImRhdGEiLCJ3IiwicmVtb3ZlQXR0ciIsImluaXQiLCJjcmVhdGUiLCJqUXVlcnkiLCJGYWN0b3J5IiwiY3JlYXRlV2lkZ2V0RmFjdG9yaWFsIiwiaWR4IiwiY29uZmlnIiwid2hlbiIsInRoZW4iLCJydW4iLCJXaWRnZXQiLCJlbnYiLCJhc3NldHNQYXRoIiwiZ2V0U3R5bGVTaGVldCIsInVybCIsIiRkIiwiRGVmZXJyZWQiLCJsaW5rIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwicmVsIiwiaHJlZiIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYXBwZW5kQ2hpbGQiLCJyZXNvbHZlIiwicHJvbWlzZSIsImdldE1haW5TaWRlS2l0U2NyaXB0VGFnIiwiY3VycmVudFNjcmlwdCIsInNyYyIsInNjcmlwdHMiLCJnZXRBdHRyaWJ1dGUiLCJnZXRBc3NldHNQYXRoIiwic2NyaXB0IiwiJGVsIiwiaHRtbCIsIl9fZXJyb3IiXSwibWFwcGluZ3MiOiJDQU9DLFNBQXlCQSxFQUFRQyxHQUNULGdCQUFaQyxVQUF3QkEsU0FBdUMsZ0JBQXJCQSxTQUFRQyxTQUMzREYsRUFBUUMsU0FDbUIsa0JBQVhFLFNBQXlCQSxPQUFPQyxJQUNoREQsUUFBUSxXQUFZSCxJQUVwQkQsRUFBT00sWUFDUEwsRUFBUUQsRUFBT00sWUFFakJDLEtBQU0sU0FBMEJDLEdBT2hDLFFBQVNDLEdBQVlDLEdBQ25CLE1BQXlCLGtCQUFYQSxHQU9oQixRQUFTQyxHQUFTQyxHQUNoQixNQUFPQyxHQUFRRCxHQUFPLGNBQWlCQSxHQUd6QyxRQUFTRSxHQUFjQyxHQUNyQixNQUFPQSxHQUFPQyxRQUFRLDhCQUErQixRQU92RCxRQUFTQyxHQUFhTCxFQUFLTSxHQUN6QixNQUFjLE9BQVBOLEdBQThCLGdCQUFSQSxJQUFxQk0sSUFBWU4sR0FNaEUsUUFBU08sR0FBWUMsRUFBSUwsR0FDdkIsTUFBT00sR0FBV0MsS0FBS0YsRUFBSUwsR0FJN0IsUUFBU1EsR0FBY1IsR0FDckIsT0FBUUksRUFBV0ssRUFBWVQsR0FjakMsUUFBU1UsR0FBWVYsR0FDbkIsTUFBT1csUUFBT1gsR0FBUUMsUUFBUSxlQUFnQixTQUF3QlcsR0FDcEUsTUFBT0MsR0FBVUQsS0FnQ3JCLFFBQVNFLEdBQWVDLEVBQVVDLEdBWWhDLFFBQVNDLEtBQ1AsR0FBSUMsSUFBV0MsRUFD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anMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIG11c3RhY2hlLmpzIC0gTG9naWMtbGVzcyB7e211c3RhY2hlfX0gdGVtcGxhdGVzIHdpdGggSmF2YVNjcmlwdFxuICogaHR0cDovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qc1xuICovXG5cbi8qZ2xvYmFsIGRlZmluZTogZmFsc2UgTXVzdGFjaGU6IHRydWUqL1xuXG4oZnVuY3Rpb24gZGVmaW5lTXVzdGFjaGUgKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYgdHlwZW9mIGV4cG9ydHMubm9kZU5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgZmFjdG9yeShleHBvcnRzKTsgLy8gQ29tbW9uSlNcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoWydleHBvcnRzJ10sIGZhY3RvcnkpOyAvLyBBTURcbiAgfSBlbHNlIHtcbiAgICBnbG9iYWwuTXVzdGFjaGUgPSB7fTtcbiAgICBmYWN0b3J5KGdsb2JhbC5NdXN0YWNoZSk7IC8vIHNjcmlwdCwgd3NoLCBhc3BcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiBtdXN0YWNoZUZhY3RvcnkgKG11c3RhY2hlKSB7XG5cbiAgdmFyIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXlQb2x5ZmlsbCAob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcblxuICBmdW5jdGlvbiBpc0Z1bmN0aW9uIChvYmplY3QpIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iamVjdCA9PT0gJ2Z1bmN0aW9uJztcbiAgfVxuXG4gIC8qKlxuICAgKiBNb3JlIGNvcnJlY3QgdHlwZW9mIHN0cmluZyBoYW5kbGluZyBhcnJheVxuICAgKiB3aGljaCBub3JtYWxseSByZXR1cm5zIHR5cGVvZiAnb2JqZWN0J1xuICAgKi9cbiAgZnVuY3Rpb24gdHlwZVN0ciAob2JqKSB7XG4gICAgcmV0dXJuIGlzQXJyYXkob2JqKSA/ICdhcnJheScgOiB0eXBlb2Ygb2JqO1xuICB9XG5cbiAgZnVuY3Rpb24gZXNjYXBlUmVnRXhwIChzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoL1tcXC1cXFtcXF17fSgpKis/LixcXFxcXFxeJHwjXFxzXS9nLCAnXFxcXCQmJyk7XG4gIH1cblxuICAvKipcbiAgICogTnVsbCBzYWZlIHdheSBvZiBjaGVja2luZyB3aGV0aGVyIG9yIG5vdCBhbiBvYmplY3QsXG4gICAqIGluY2x1ZGluZyBpdHMgcHJvdG90eXBlLCBoYXMgYSBnaXZlbiBwcm9wZXJ0eVxuICAgKi9cbiAgZnVuY3Rpb24gaGFzUHJvcGVydHkgKG9iaiwgcHJvcE5hbWUpIHtcbiAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgKHByb3BOYW1lIGluIG9iaik7XG4gIH1cblxuICAvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0NPVUNIREItNTc3XG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFubC9tdXN0YWNoZS5qcy9pc3N1ZXMvMTg5XG4gIHZhciByZWdFeHBUZXN0ID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0O1xuICBmdW5jdGlvbiB0ZXN0UmVnRXhwIChyZSwgc3RyaW5nKSB7XG4gICAgcmV0dXJuIHJlZ0V4cFRlc3QuY2FsbChyZSwgc3RyaW5nKTtcbiAgfVxuXG4gIHZhciBub25TcGFjZVJlID0gL1xcUy87XG4gIGZ1bmN0aW9uIGlzV2hpdGVzcGFjZSAoc3RyaW5nKSB7XG4gICAgcmV0dXJuICF0ZXN0UmVnRXhwKG5vblNwYWNlUmUsIHN0cmluZyk7XG4gIH1cblxuICB2YXIgZW50aXR5TWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnLyc6ICcmI3gyRjsnLFxuICAgICdgJzogJyYjeDYwOycsXG4gICAgJz0nOiAnJiN4M0Q7J1xuICB9O1xuXG4gIGZ1bmN0aW9uIGVzY2FwZUh0bWwgKHN0cmluZykge1xuICAgIHJldHVybiBTdHJpbmcoc3RyaW5nKS5yZXBsYWNlKC9bJjw+XCInYD1cXC9dL2csIGZ1bmN0aW9uIGZyb21FbnRpdHlNYXAgKHMpIHtcbiAgICAgIHJldHVybiBlbnRpdHlNYXBbc107XG4gICAgfSk7XG4gIH1cblxuICB2YXIgd2hpdGVSZSA9IC9cXHMqLztcbiAgdmFyIHNwYWNlUmUgPSAvXFxzKy87XG4gIHZhciBlcXVhbHNSZSA9IC9cXHMqPS87XG4gIHZhciBjdXJseVJlID0gL1xccypcXH0vO1xuICB2YXIgdGFnUmUgPSAvI3xcXF58XFwvfD58XFx7fCZ8PXwhLztcblxuICAvKipcbiAgICogQnJlYWtzIHVwIHRoZSBnaXZlbiBgdGVtcGxhdGVgIHN0cmluZyBpbnRvIGEgdHJlZSBvZiB0b2tlbnMuIElmIHRoZSBgdGFnc2BcbiAgICogYXJndW1lbnQgaXMgZ2l2ZW4gaGVyZSBpdCBtdXN0IGJlIGFuIGFycmF5IHdpdGggdHdvIHN0cmluZyB2YWx1ZXM6IHRoZVxuICAgKiBvcGVuaW5nIGFuZCBjbG9zaW5nIHRhZ3MgdXNlZCBpbiB0aGUgdGVtcGxhdGUgKGUuZy4gWyBcIjwlXCIsIFwiJT5cIiBdKS4gT2ZcbiAgICogY291cnNlLCB0aGUgZGVmYXVsdCBpcyB0byB1c2UgbXVzdGFjaGVzIChpLmUuIG11c3RhY2hlLnRhZ3MpLlxuICAgKlxuICAgKiBBIHRva2VuIGlzIGFuIGFycmF5IHdpdGggYXQgbGVhc3QgNCBlbGVtZW50cy4gVGhlIGZpcnN0IGVsZW1lbnQgaXMgdGhlXG4gICAqIG11c3RhY2hlIHN5bWJvbCB0aGF0IHdhcyB1c2VkIGluc2lkZSB0aGUgdGFnLCBlLmcuIFwiI1wiIG9yIFwiJlwiLiBJZiB0aGUgdGFnXG4gICAqIGRpZCBub3QgY29udGFpbiBhIHN5bWJvbCAoaS5lLiB7e215VmFsdWV9fSkgdGhpcyBlbGVtZW50IGlzIFwibmFtZVwiLiBGb3JcbiAgICogYWxsIHRleHQgdGhhdCBhcHBlYXJzIG91dHNpZGUgYSBzeW1ib2wgdGhpcyBlbGVtZW50IGlzIFwidGV4dFwiLlxuICAgKlxuICAgKiBUaGUgc2Vjb25kIGVsZW1lbnQgb2YgYSB0b2tlbiBpcyBpdHMgXCJ2YWx1ZVwiLiBGb3IgbXVzdGFjaGUgdGFncyB0aGlzIGlzXG4gICAqIHdoYXRldmVyIGVsc2Ugd2FzIGluc2lkZSB0aGUgdGFnIGJlc2lkZXMgdGhlIG9wZW5pbmcgc3ltYm9sLiBGb3IgdGV4dCB0b2tlbnNcbiAgICogdGhpcyBpcyB0aGUgdGV4dCBpdHNlbGYuXG4gICAqXG4gICAqIFRoZSB0aGlyZCBhbmQgZm91cnRoIGVsZW1lbnRzIG9mIHRoZSB0b2tlbiBhcmUgdGhlIHN0YXJ0IGFuZCBlbmQgaW5kaWNlcyxcbiAgICogcmVzcGVjdGl2ZWx5LCBvZiB0aGUgdG9rZW4gaW4gdGhlIG9yaWdpbmFsIHRlbXBsYXRlLlxuICAgKlxuICAgKiBUb2tlbnMgdGhhdCBhcmUgdGhlIHJvb3Qgbm9kZSBvZiBhIHN1YnRyZWUgY29udGFpbiB0d28gbW9yZSBlbGVtZW50czogMSkgYW5cbiAgICogYXJyYXkgb2YgdG9rZW5zIGluIHRoZSBzdWJ0cmVlIGFuZCAyKSB0aGUgaW5kZXggaW4gdGhlIG9yaWdpbmFsIHRlbXBsYXRlIGF0XG4gICAqIHdoaWNoIHRoZSBjbG9zaW5nIHRhZyBmb3IgdGhhdCBzZWN0aW9uIGJlZ2lucy5cbiAgICovXG4gIGZ1bmN0aW9uIHBhcnNlVGVtcGxhdGUgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgaWYgKCF0ZW1wbGF0ZSlcbiAgICAgIHJldHVybiBbXTtcblxuICAgIHZhciBzZWN0aW9ucyA9IFtdOyAgICAgLy8gU3RhY2sgdG8gaG9sZCBzZWN0aW9uIHRva2Vuc1xuICAgIHZhciB0b2tlbnMgPSBbXTsgICAgICAgLy8gQnVmZmVyIHRvIGhvbGQgdGhlIHRva2Vuc1xuICAgIHZhciBzcGFjZXMgPSBbXTsgICAgICAgLy8gSW5kaWNlcyBvZiB3aGl0ZXNwYWNlIHRva2VucyBvbiB0aGUgY3VycmVudCBsaW5lXG4gICAgdmFyIGhhc1RhZyA9IGZhbHNlOyAgICAvLyBJcyB0aGVyZSBhIHt7dGFnfX0gb24gdGhlIGN1cnJlbnQgbGluZT9cbiAgICB2YXIgbm9uU3BhY2UgPSBmYWxzZTsgIC8vIElzIHRoZXJlIGEgbm9uLXNwYWNlIGNoYXIgb24gdGhlIGN1cnJlbnQgbGluZT9cblxuICAgIC8vIFN0cmlwcyBhbGwgd2hpdGVzcGFjZSB0b2tlbnMgYXJyYXkgZm9yIHRoZSBjdXJyZW50IGxpbmVcbiAgICAvLyBpZiB0aGVyZSB3YXMgYSB7eyN0YWd9fSBvbiBpdCBhbmQgb3RoZXJ3aXNlIG9ubHkgc3BhY2UuXG4gICAgZnVuY3Rpb24gc3RyaXBTcGFjZSAoKSB7XG4gICAgICBpZiAoaGFzVGFnICYmICFub25TcGFjZSkge1xuICAgICAgICB3aGlsZSAoc3BhY2VzLmxlbmd0aClcbiAgICAgICAgICBkZWxldGUgdG9rZW5zW3NwYWNlcy5wb3AoKV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGFjZXMgPSBbXTtcbiAgICAgIH1cblxuICAgICAgaGFzVGFnID0gZmFsc2U7XG4gICAgICBub25TcGFjZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBvcGVuaW5nVGFnUmUsIGNsb3NpbmdUYWdSZSwgY2xvc2luZ0N1cmx5UmU7XG4gICAgZnVuY3Rpb24gY29tcGlsZVRhZ3MgKHRhZ3NUb0NvbXBpbGUpIHtcbiAgICAgIGlmICh0eXBlb2YgdGFnc1RvQ29tcGlsZSA9PT0gJ3N0cmluZycpXG4gICAgICAgIHRhZ3NUb0NvbXBpbGUgPSB0YWdzVG9Db21waWxlLnNwbGl0KHNwYWNlUmUsIDIpO1xuXG4gICAgICBpZiAoIWlzQXJyYXkodGFnc1RvQ29tcGlsZSkgfHwgdGFnc1RvQ29tcGlsZS5sZW5ndGggIT09IDIpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0YWdzOiAnICsgdGFnc1RvQ29tcGlsZSk7XG5cbiAgICAgIG9wZW5pbmdUYWdSZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHRhZ3NUb0NvbXBpbGVbMF0pICsgJ1xcXFxzKicpO1xuICAgICAgY2xvc2luZ1RhZ1JlID0gbmV3IFJlZ0V4cCgnXFxcXHMqJyArIGVzY2FwZVJlZ0V4cCh0YWdzVG9Db21waWxlWzFdKSk7XG4gICAgICBjbG9zaW5nQ3VybHlSZSA9IG5ldyBSZWdFeHAoJ1xcXFxzKicgKyBlc2NhcGVSZWdFeHAoJ30nICsgdGFnc1RvQ29tcGlsZVsxXSkpO1xuICAgIH1cblxuICAgIGNvbXBpbGVUYWdzKHRhZ3MgfHwgbXVzdGFjaGUudGFncyk7XG5cbiAgICB2YXIgc2Nhbm5lciA9IG5ldyBTY2FubmVyKHRlbXBsYXRlKTtcblxuICAgIHZhciBzdGFydCwgdHlwZSwgdmFsdWUsIGNociwgdG9rZW4sIG9wZW5TZWN0aW9uO1xuICAgIHdoaWxlICghc2Nhbm5lci5lb3MoKSkge1xuICAgICAgc3RhcnQgPSBzY2FubmVyLnBvcztcblxuICAgICAgLy8gTWF0Y2ggYW55IHRleHQgYmV0d2VlbiB0YWdzLlxuICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChvcGVuaW5nVGFnUmUpO1xuXG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgdmFsdWVMZW5ndGg7ICsraSkge1xuICAgICAgICAgIGNociA9IHZhbHVlLmNoYXJBdChpKTtcblxuICAgICAgICAgIGlmIChpc1doaXRlc3BhY2UoY2hyKSkge1xuICAgICAgICAgICAgc3BhY2VzLnB1c2godG9rZW5zLmxlbmd0aCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5vblNwYWNlID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0b2tlbnMucHVzaChbICd0ZXh0JywgY2hyLCBzdGFydCwgc3RhcnQgKyAxIF0pO1xuICAgICAgICAgIHN0YXJ0ICs9IDE7XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3Igd2hpdGVzcGFjZSBvbiB0aGUgY3VycmVudCBsaW5lLlxuICAgICAgICAgIGlmIChjaHIgPT09ICdcXG4nKVxuICAgICAgICAgICAgc3RyaXBTcGFjZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE1hdGNoIHRoZSBvcGVuaW5nIHRhZy5cbiAgICAgIGlmICghc2Nhbm5lci5zY2FuKG9wZW5pbmdUYWdSZSkpXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBoYXNUYWcgPSB0cnVlO1xuXG4gICAgICAvLyBHZXQgdGhlIHRhZyB0eXBlLlxuICAgICAgdHlwZSA9IHNjYW5uZXIuc2Nhbih0YWdSZSkgfHwgJ25hbWUnO1xuICAgICAgc2Nhbm5lci5zY2FuKHdoaXRlUmUpO1xuXG4gICAgICAvLyBHZXQgdGhlIHRhZyB2YWx1ZS5cbiAgICAgIGlmICh0eXBlID09PSAnPScpIHtcbiAgICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChlcXVhbHNSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhbihlcXVhbHNSZSk7XG4gICAgICAgIHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd7Jykge1xuICAgICAgICB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdDdXJseVJlKTtcbiAgICAgICAgc2Nhbm5lci5zY2FuKGN1cmx5UmUpO1xuICAgICAgICBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgICB0eXBlID0gJyYnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nVGFnUmUpO1xuICAgICAgfVxuXG4gICAgICAvLyBNYXRjaCB0aGUgY2xvc2luZyB0YWcuXG4gICAgICBpZiAoIXNjYW5uZXIuc2NhbihjbG9zaW5nVGFnUmUpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHRhZyBhdCAnICsgc2Nhbm5lci5wb3MpO1xuXG4gICAgICB0b2tlbiA9IFsgdHlwZSwgdmFsdWUsIHN0YXJ0LCBzY2FubmVyLnBvcyBdO1xuICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuXG4gICAgICBpZiAodHlwZSA9PT0gJyMnIHx8IHR5cGUgPT09ICdeJykge1xuICAgICAgICBzZWN0aW9ucy5wdXNoKHRva2VuKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJy8nKSB7XG4gICAgICAgIC8vIENoZWNrIHNlY3Rpb24gbmVzdGluZy5cbiAgICAgICAgb3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKTtcblxuICAgICAgICBpZiAoIW9wZW5TZWN0aW9uKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5vcGVuZWQgc2VjdGlvbiBcIicgKyB2YWx1ZSArICdcIiBhdCAnICsgc3RhcnQpO1xuXG4gICAgICAgIGlmIChvcGVuU2VjdGlvblsxXSAhPT0gdmFsdWUpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uIFwiJyArIG9wZW5TZWN0aW9uWzFdICsgJ1wiIGF0ICcgKyBzdGFydCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICduYW1lJyB8fCB0eXBlID09PSAneycgfHwgdHlwZSA9PT0gJyYnKSB7XG4gICAgICAgIG5vblNwYWNlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJz0nKSB7XG4gICAgICAgIC8vIFNldCB0aGUgdGFncyBmb3IgdGhlIG5leHQgdGltZSBhcm91bmQuXG4gICAgICAgIGNvbXBpbGVUYWdzKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBNYWtlIHN1cmUgdGhlcmUgYXJlIG5vIG9wZW4gc2VjdGlvbnMgd2hlbiB3ZSdyZSBkb25lLlxuICAgIG9wZW5TZWN0aW9uID0gc2VjdGlvbnMucG9wKCk7XG5cbiAgICBpZiAob3BlblNlY3Rpb24pXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuY2xvc2VkIHNlY3Rpb24gXCInICsgb3BlblNlY3Rpb25bMV0gKyAnXCIgYXQgJyArIHNjYW5uZXIucG9zKTtcblxuICAgIHJldHVybiBuZXN0VG9rZW5zKHNxdWFzaFRva2Vucyh0b2tlbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21iaW5lcyB0aGUgdmFsdWVzIG9mIGNvbnNlY3V0aXZlIHRleHQgdG9rZW5zIGluIHRoZSBnaXZlbiBgdG9rZW5zYCBhcnJheVxuICAgKiB0byBhIHNpbmdsZSB0b2tlbi5cbiAgICovXG4gIGZ1bmN0aW9uIHNxdWFzaFRva2VucyAodG9rZW5zKSB7XG4gICAgdmFyIHNxdWFzaGVkVG9rZW5zID0gW107XG5cbiAgICB2YXIgdG9rZW4sIGxhc3RUb2tlbjtcbiAgICBmb3IgKHZhciBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7XG4gICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlblswXSA9PT0gJ3RleHQnICYmIGxhc3RUb2tlbiAmJiBsYXN0VG9rZW5bMF0gPT09ICd0ZXh0Jykge1xuICAgICAgICAgIGxhc3RUb2tlblsxXSArPSB0b2tlblsxXTtcbiAgICAgICAgICBsYXN0VG9rZW5bM10gPSB0b2tlblszXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcXVhc2hlZFRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgICAgICBsYXN0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzcXVhc2hlZFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtcyB0aGUgZ2l2ZW4gYXJyYXkgb2YgYHRva2Vuc2AgaW50byBhIG5lc3RlZCB0cmVlIHN0cnVjdHVyZSB3aGVyZVxuICAgKiB0b2tlbnMgdGhhdCByZXByZXNlbnQgYSBzZWN0aW9uIGhhdmUgdHdvIGFkZGl0aW9uYWwgaXRlbXM6IDEpIGFuIGFycmF5IG9mXG4gICAqIGFsbCB0b2tlbnMgdGhhdCBhcHBlYXIgaW4gdGhhdCBzZWN0aW9uIGFuZCAyKSB0aGUgaW5kZXggaW4gdGhlIG9yaWdpbmFsXG4gICAqIHRlbXBsYXRlIHRoYXQgcmVwcmVzZW50cyB0aGUgZW5kIG9mIHRoYXQgc2VjdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIG5lc3RUb2tlbnMgKHRva2Vucykge1xuICAgIHZhciBuZXN0ZWRUb2tlbnMgPSBbXTtcbiAgICB2YXIgY29sbGVjdG9yID0gbmVzdGVkVG9rZW5zO1xuICAgIHZhciBzZWN0aW9ucyA9IFtdO1xuXG4gICAgdmFyIHRva2VuLCBzZWN0aW9uO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHRva2VuID0gdG9rZW5zW2ldO1xuXG4gICAgICBzd2l0Y2ggKHRva2VuWzBdKSB7XG4gICAgICAgIGNhc2UgJyMnOlxuICAgICAgICBjYXNlICdeJzpcbiAgICAgICAgICBjb2xsZWN0b3IucHVzaCh0b2tlbik7XG4gICAgICAgICAgc2VjdGlvbnMucHVzaCh0b2tlbik7XG4gICAgICAgICAgY29sbGVjdG9yID0gdG9rZW5bNF0gPSBbXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnLyc6XG4gICAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpO1xuICAgICAgICAgIHNlY3Rpb25bNV0gPSB0b2tlblsyXTtcbiAgICAgICAgICBjb2xsZWN0b3IgPSBzZWN0aW9ucy5sZW5ndGggPiAwID8gc2VjdGlvbnNbc2VjdGlvbnMubGVuZ3RoIC0gMV1bNF0gOiBuZXN0ZWRUb2tlbnM7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29sbGVjdG9yLnB1c2godG9rZW4pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXN0ZWRUb2tlbnM7XG4gIH1cblxuICAvKipcbiAgICogQSBzaW1wbGUgc3RyaW5nIHNjYW5uZXIgdGhhdCBpcyB1c2VkIGJ5IHRoZSB0ZW1wbGF0ZSBwYXJzZXIgdG8gZmluZFxuICAgKiB0b2tlbnMgaW4gdGVtcGxhdGUgc3RyaW5ncy5cbiAgICovXG4gIGZ1bmN0aW9uIFNjYW5uZXIgKHN0cmluZykge1xuICAgIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xuICAgIHRoaXMudGFpbCA9IHN0cmluZztcbiAgICB0aGlzLnBvcyA9IDA7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHRhaWwgaXMgZW1wdHkgKGVuZCBvZiBzdHJpbmcpLlxuICAgKi9cbiAgU2Nhbm5lci5wcm90b3R5cGUuZW9zID0gZnVuY3Rpb24gZW9zICgpIHtcbiAgICByZXR1cm4gdGhpcy50YWlsID09PSAnJztcbiAgfTtcblxuICAvKipcbiAgICogVHJpZXMgdG8gbWF0Y2ggdGhlIGdpdmVuIHJlZ3VsYXIgZXhwcmVzc2lvbiBhdCB0aGUgY3VycmVudCBwb3NpdGlvbi5cbiAgICogUmV0dXJucyB0aGUgbWF0Y2hlZCB0ZXh0IGlmIGl0IGNhbiBtYXRjaCwgdGhlIGVtcHR5IHN0cmluZyBvdGhlcndpc2UuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuID0gZnVuY3Rpb24gc2NhbiAocmUpIHtcbiAgICB2YXIgbWF0Y2ggPSB0aGlzLnRhaWwubWF0Y2gocmUpO1xuXG4gICAgaWYgKCFtYXRjaCB8fCBtYXRjaC5pbmRleCAhPT0gMClcbiAgICAgIHJldHVybiAnJztcblxuICAgIHZhciBzdHJpbmcgPSBtYXRjaFswXTtcblxuICAgIHRoaXMudGFpbCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoc3RyaW5nLmxlbmd0aCk7XG4gICAgdGhpcy5wb3MgKz0gc3RyaW5nLmxlbmd0aDtcblxuICAgIHJldHVybiBzdHJpbmc7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNraXBzIGFsbCB0ZXh0IHVudGlsIHRoZSBnaXZlbiByZWd1bGFyIGV4cHJlc3Npb24gY2FuIGJlIG1hdGNoZWQuIFJldHVybnNcbiAgICogdGhlIHNraXBwZWQgc3RyaW5nLCB3aGljaCBpcyB0aGUgZW50aXJlIHRhaWwgaWYgbm8gbWF0Y2ggY2FuIGJlIG1hZGUuXG4gICAqL1xuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuVW50aWwgPSBmdW5jdGlvbiBzY2FuVW50aWwgKHJlKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy50YWlsLnNlYXJjaChyZSksIG1hdGNoO1xuXG4gICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgY2FzZSAtMTpcbiAgICAgICAgbWF0Y2ggPSB0aGlzLnRhaWw7XG4gICAgICAgIHRoaXMudGFpbCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgbWF0Y2ggPSAnJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBtYXRjaCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgICAgICB0aGlzLnRhaWwgPSB0aGlzLnRhaWwuc3Vic3RyaW5nKGluZGV4KTtcbiAgICB9XG5cbiAgICB0aGlzLnBvcyArPSBtYXRjaC5sZW5ndGg7XG5cbiAgICByZXR1cm4gbWF0Y2g7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcHJlc2VudHMgYSByZW5kZXJpbmcgY29udGV4dCBieSB3cmFwcGluZyBhIHZpZXcgb2JqZWN0IGFuZFxuICAgKiBtYWludGFpbmluZyBhIHJlZmVyZW5jZSB0byB0aGUgcGFyZW50IGNvbnRleHQuXG4gICAqL1xuICBmdW5jdGlvbiBDb250ZXh0ICh2aWV3LCBwYXJlbnRDb250ZXh0KSB7XG4gICAgdGhpcy52aWV3ID0gdmlldztcbiAgICB0aGlzLmNhY2hlID0geyAnLic6IHRoaXMudmlldyB9O1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50Q29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGNvbnRleHQgdXNpbmcgdGhlIGdpdmVuIHZpZXcgd2l0aCB0aGlzIGNvbnRleHRcbiAgICogYXMgdGhlIHBhcmVudC5cbiAgICovXG4gIENvbnRleHQucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiBwdXNoICh2aWV3KSB7XG4gICAgcmV0dXJuIG5ldyBDb250ZXh0KHZpZXcsIHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gbmFtZSBpbiB0aGlzIGNvbnRleHQsIHRyYXZlcnNpbmdcbiAgICogdXAgdGhlIGNvbnRleHQgaGllcmFyY2h5IGlmIHRoZSB2YWx1ZSBpcyBhYnNlbnQgaW4gdGhpcyBjb250ZXh0J3Mgdmlldy5cbiAgICovXG4gIENvbnRleHQucHJvdG90eXBlLmxvb2t1cCA9IGZ1bmN0aW9uIGxvb2t1cCAobmFtZSkge1xuICAgIHZhciBjYWNoZSA9IHRoaXMuY2FjaGU7XG5cbiAgICB2YXIgdmFsdWU7XG4gICAgaWYgKGNhY2hlLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICB2YWx1ZSA9IGNhY2hlW25hbWVdO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgY29udGV4dCA9IHRoaXMsIG5hbWVzLCBpbmRleCwgbG9va3VwSGl0ID0gZmFsc2U7XG5cbiAgICAgIHdoaWxlIChjb250ZXh0KSB7XG4gICAgICAgIGlmIChuYW1lLmluZGV4T2YoJy4nKSA+IDApIHtcbiAgICAgICAgICB2YWx1ZSA9IGNvbnRleHQudmlldztcbiAgICAgICAgICBuYW1lcyA9IG5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgICBpbmRleCA9IDA7XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBVc2luZyB0aGUgZG90IG5vdGlvbiBwYXRoIGluIGBuYW1lYCwgd2UgZGVzY2VuZCB0aHJvdWdoIHRoZVxuICAgICAgICAgICAqIG5lc3RlZCBvYmplY3RzLlxuICAgICAgICAgICAqXG4gICAgICAgICAgICogVG8gYmUgY2VydGFpbiB0aGF0IHRoZSBsb29rdXAgaGFzIGJlZW4gc3VjY2Vzc2Z1bCwgd2UgaGF2ZSB0b1xuICAgICAgICAgICAqIGNoZWNrIGlmIHRoZSBsYXN0IG9iamVjdCBpbiB0aGUgcGF0aCBhY3R1YWxseSBoYXMgdGhlIHByb3BlcnR5XG4gICAgICAgICAgICogd2UgYXJlIGxvb2tpbmcgZm9yLiBXZSBzdG9yZSB0aGUgcmVzdWx0IGluIGBsb29rdXBIaXRgLlxuICAgICAgICAgICAqXG4gICAgICAgICAgICogVGhpcyBpcyBzcGVjaWFsbHkgbmVjZXNzYXJ5IGZvciB3aGVuIHRoZSB2YWx1ZSBoYXMgYmVlbiBzZXQgdG9cbiAgICAgICAgICAgKiBgdW5kZWZpbmVkYCBhbmQgd2Ugd2FudCB0byBhdm9pZCBsb29raW5nIHVwIHBhcmVudCBjb250ZXh0cy5cbiAgICAgICAgICAgKiovXG4gICAgICAgICAgd2hpbGUgKHZhbHVlICE9IG51bGwgJiYgaW5kZXggPCBuYW1lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gbmFtZXMubGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgbG9va3VwSGl0ID0gaGFzUHJvcGVydHkodmFsdWUsIG5hbWVzW2luZGV4XSk7XG5cbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbbmFtZXNbaW5kZXgrK11dO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YWx1ZSA9IGNvbnRleHQudmlld1tuYW1lXTtcbiAgICAgICAgICBsb29rdXBIaXQgPSBoYXNQcm9wZXJ0eShjb250ZXh0LnZpZXcsIG5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvb2t1cEhpdClcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjb250ZXh0ID0gY29udGV4dC5wYXJlbnQ7XG4gICAgICB9XG5cbiAgICAgIGNhY2hlW25hbWVdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKVxuICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKHRoaXMudmlldyk7XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIEEgV3JpdGVyIGtub3dzIGhvdyB0byB0YWtlIGEgc3RyZWFtIG9mIHRva2VucyBhbmQgcmVuZGVyIHRoZW0gdG8gYVxuICAgKiBzdHJpbmcsIGdpdmVuIGEgY29udGV4dC4gSXQgYWxzbyBtYWludGFpbnMgYSBjYWNoZSBvZiB0ZW1wbGF0ZXMgdG9cbiAgICogYXZvaWQgdGhlIG5lZWQgdG8gcGFyc2UgdGhlIHNhbWUgdGVtcGxhdGUgdHdpY2UuXG4gICAqL1xuICBmdW5jdGlvbiBXcml0ZXIgKCkge1xuICAgIHRoaXMuY2FjaGUgPSB7fTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhcnMgYWxsIGNhY2hlZCB0ZW1wbGF0ZXMgaW4gdGhpcyB3cml0ZXIuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgICB0aGlzLmNhY2hlID0ge307XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBhbmQgY2FjaGVzIHRoZSBnaXZlbiBgdGVtcGxhdGVgIGFuZCByZXR1cm5zIHRoZSBhcnJheSBvZiB0b2tlbnNcbiAgICogdGhhdCBpcyBnZW5lcmF0ZWQgZnJvbSB0aGUgcGFyc2UuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gcGFyc2UgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcbiAgICB2YXIgdG9rZW5zID0gY2FjaGVbdGVtcGxhdGVdO1xuXG4gICAgaWYgKHRva2VucyA9PSBudWxsKVxuICAgICAgdG9rZW5zID0gY2FjaGVbdGVtcGxhdGVdID0gcGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgdGFncyk7XG5cbiAgICByZXR1cm4gdG9rZW5zO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIaWdoLWxldmVsIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gcmVuZGVyIHRoZSBnaXZlbiBgdGVtcGxhdGVgIHdpdGhcbiAgICogdGhlIGdpdmVuIGB2aWV3YC5cbiAgICpcbiAgICogVGhlIG9wdGlvbmFsIGBwYXJ0aWFsc2AgYXJndW1lbnQgbWF5IGJlIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZVxuICAgKiBuYW1lcyBhbmQgdGVtcGxhdGVzIG9mIHBhcnRpYWxzIHRoYXQgYXJlIHVzZWQgaW4gdGhlIHRlbXBsYXRlLiBJdCBtYXlcbiAgICogYWxzbyBiZSBhIGZ1bmN0aW9uIHRoYXQgaXMgdXNlZCB0byBsb2FkIHBhcnRpYWwgdGVtcGxhdGVzIG9uIHRoZSBmbHlcbiAgICogdGhhdCB0YWtlcyBhIHNpbmdsZSBhcmd1bWVudDogdGhlIG5hbWUgb2YgdGhlIHBhcnRpYWwuXG4gICAqL1xuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKSB7XG4gICAgdmFyIHRva2VucyA9IHRoaXMucGFyc2UodGVtcGxhdGUpO1xuICAgIHZhciBjb250ZXh0ID0gKHZpZXcgaW5zdGFuY2VvZiBDb250ZXh0KSA/IHZpZXcgOiBuZXcgQ29udGV4dCh2aWV3KTtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5zLCBjb250ZXh0LCBwYXJ0aWFscywgdGVtcGxhdGUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBMb3ctbGV2ZWwgbWV0aG9kIHRoYXQgcmVuZGVycyB0aGUgZ2l2ZW4gYXJyYXkgb2YgYHRva2Vuc2AgdXNpbmdcbiAgICogdGhlIGdpdmVuIGBjb250ZXh0YCBhbmQgYHBhcnRpYWxzYC5cbiAgICpcbiAgICogTm90ZTogVGhlIGBvcmlnaW5hbFRlbXBsYXRlYCBpcyBvbmx5IGV2ZXIgdXNlZCB0byBleHRyYWN0IHRoZSBwb3J0aW9uXG4gICAqIG9mIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSB0aGF0IHdhcyBjb250YWluZWQgaW4gYSBoaWdoZXItb3JkZXIgc2VjdGlvbi5cbiAgICogSWYgdGhlIHRlbXBsYXRlIGRvZXNuJ3QgdXNlIGhpZ2hlci1vcmRlciBzZWN0aW9ucywgdGhpcyBhcmd1bWVudCBtYXlcbiAgICogYmUgb21pdHRlZC5cbiAgICovXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVyVG9rZW5zID0gZnVuY3Rpb24gcmVuZGVyVG9rZW5zICh0b2tlbnMsIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuXG4gICAgdmFyIHRva2VuLCBzeW1ib2wsIHZhbHVlO1xuICAgIGZvciAodmFyIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHtcbiAgICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG4gICAgICBzeW1ib2wgPSB0b2tlblswXTtcblxuICAgICAgaWYgKHN5bWJvbCA9PT0gJyMnKSB2YWx1ZSA9IHRoaXMucmVuZGVyU2VjdGlvbih0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnXicpIHZhbHVlID0gdGhpcy5yZW5kZXJJbnZlcnRlZCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgICAgZWxzZSBpZiAoc3ltYm9sID09PSAnPicpIHZhbHVlID0gdGhpcy5yZW5kZXJQYXJ0aWFsKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSk7XG4gICAgICBlbHNlIGlmIChzeW1ib2wgPT09ICcmJykgdmFsdWUgPSB0aGlzLnVuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ25hbWUnKSB2YWx1ZSA9IHRoaXMuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KTtcbiAgICAgIGVsc2UgaWYgKHN5bWJvbCA9PT0gJ3RleHQnKSB2YWx1ZSA9IHRoaXMucmF3VmFsdWUodG9rZW4pO1xuXG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZClcbiAgICAgICAgYnVmZmVyICs9IHZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBidWZmZXI7XG4gIH07XG5cbiAgV3JpdGVyLnByb3RvdHlwZS5yZW5kZXJTZWN0aW9uID0gZnVuY3Rpb24gcmVuZGVyU2VjdGlvbiAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBidWZmZXIgPSAnJztcbiAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7XG5cbiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIGFuIGFyYml0cmFyeSB0ZW1wbGF0ZVxuICAgIC8vIGluIHRoZSBjdXJyZW50IGNvbnRleHQgYnkgaGlnaGVyLW9yZGVyIHNlY3Rpb25zLlxuICAgIGZ1bmN0aW9uIHN1YlJlbmRlciAodGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiBzZWxmLnJlbmRlcih0ZW1wbGF0ZSwgY29udGV4dCwgcGFydGlhbHMpO1xuICAgIH1cblxuICAgIGlmICghdmFsdWUpIHJldHVybjtcblxuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgZm9yICh2YXIgaiA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBqIDwgdmFsdWVMZW5ndGg7ICsraikge1xuICAgICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZVtqXSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICBpZiAodHlwZW9mIG9yaWdpbmFsVGVtcGxhdGUgIT09ICdzdHJpbmcnKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCB1c2UgaGlnaGVyLW9yZGVyIHNlY3Rpb25zIHdpdGhvdXQgdGhlIG9yaWdpbmFsIHRlbXBsYXRlJyk7XG5cbiAgICAgIC8vIEV4dHJhY3QgdGhlIHBvcnRpb24gb2YgdGhlIG9yaWdpbmFsIHRlbXBsYXRlIHRoYXQgdGhlIHNlY3Rpb24gY29udGFpbnMuXG4gICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwoY29udGV4dC52aWV3LCBvcmlnaW5hbFRlbXBsYXRlLnNsaWNlKHRva2VuWzNdLCB0b2tlbls1XSksIHN1YlJlbmRlcik7XG5cbiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgICBidWZmZXIgKz0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmVuZGVySW52ZXJ0ZWQgPSBmdW5jdGlvbiByZW5kZXJJbnZlcnRlZCAodG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuXG4gICAgLy8gVXNlIEphdmFTY3JpcHQncyBkZWZpbml0aW9uIG9mIGZhbHN5LiBJbmNsdWRlIGVtcHR5IGFycmF5cy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMvaXNzdWVzLzE4NlxuICAgIGlmICghdmFsdWUgfHwgKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkpXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnJlbmRlclBhcnRpYWwgPSBmdW5jdGlvbiByZW5kZXJQYXJ0aWFsICh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMpIHtcbiAgICBpZiAoIXBhcnRpYWxzKSByZXR1cm47XG5cbiAgICB2YXIgdmFsdWUgPSBpc0Z1bmN0aW9uKHBhcnRpYWxzKSA/IHBhcnRpYWxzKHRva2VuWzFdKSA6IHBhcnRpYWxzW3Rva2VuWzFdXTtcbiAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0aGlzLnBhcnNlKHZhbHVlKSwgY29udGV4dCwgcGFydGlhbHMsIHZhbHVlKTtcbiAgfTtcblxuICBXcml0ZXIucHJvdG90eXBlLnVuZXNjYXBlZFZhbHVlID0gZnVuY3Rpb24gdW5lc2NhcGVkVmFsdWUgKHRva2VuLCBjb250ZXh0KSB7XG4gICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUuZXNjYXBlZFZhbHVlID0gZnVuY3Rpb24gZXNjYXBlZFZhbHVlICh0b2tlbiwgY29udGV4dCkge1xuICAgIHZhciB2YWx1ZSA9IGNvbnRleHQubG9va3VwKHRva2VuWzFdKTtcbiAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgIHJldHVybiBtdXN0YWNoZS5lc2NhcGUodmFsdWUpO1xuICB9O1xuXG4gIFdyaXRlci5wcm90b3R5cGUucmF3VmFsdWUgPSBmdW5jdGlvbiByYXdWYWx1ZSAodG9rZW4pIHtcbiAgICByZXR1cm4gdG9rZW5bMV07XG4gIH07XG5cbiAgbXVzdGFjaGUubmFtZSA9ICdtdXN0YWNoZS5qcyc7XG4gIG11c3RhY2hlLnZlcnNpb24gPSAnMi4yLjEnO1xuICBtdXN0YWNoZS50YWdzID0gWyAne3snLCAnfX0nIF07XG5cbiAgLy8gQWxsIGhpZ2gtbGV2ZWwgbXVzdGFjaGUuKiBmdW5jdGlvbnMgdXNlIHRoaXMgd3JpdGVyLlxuICB2YXIgZGVmYXVsdFdyaXRlciA9IG5ldyBXcml0ZXIoKTtcblxuICAvKipcbiAgICogQ2xlYXJzIGFsbCBjYWNoZWQgdGVtcGxhdGVzIGluIHRoZSBkZWZhdWx0IHdyaXRlci5cbiAgICovXG4gIG11c3RhY2hlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlICgpIHtcbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5jbGVhckNhY2hlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBhbmQgY2FjaGVzIHRoZSBnaXZlbiB0ZW1wbGF0ZSBpbiB0aGUgZGVmYXVsdCB3cml0ZXIgYW5kIHJldHVybnMgdGhlXG4gICAqIGFycmF5IG9mIHRva2VucyBpdCBjb250YWlucy4gRG9pbmcgdGhpcyBhaGVhZCBvZiB0aW1lIGF2b2lkcyB0aGUgbmVlZCB0b1xuICAgKiBwYXJzZSB0ZW1wbGF0ZXMgb24gdGhlIGZseSBhcyB0aGV5IGFyZSByZW5kZXJlZC5cbiAgICovXG4gIG11c3RhY2hlLnBhcnNlID0gZnVuY3Rpb24gcGFyc2UgKHRlbXBsYXRlLCB0YWdzKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucGFyc2UodGVtcGxhdGUsIHRhZ3MpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBgdGVtcGxhdGVgIHdpdGggdGhlIGdpdmVuIGB2aWV3YCBhbmQgYHBhcnRpYWxzYCB1c2luZyB0aGVcbiAgICogZGVmYXVsdCB3cml0ZXIuXG4gICAqL1xuICBtdXN0YWNoZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIgKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscykge1xuICAgIGlmICh0eXBlb2YgdGVtcGxhdGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRlbXBsYXRlISBUZW1wbGF0ZSBzaG91bGQgYmUgYSBcInN0cmluZ1wiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYnV0IFwiJyArIHR5cGVTdHIodGVtcGxhdGUpICsgJ1wiIHdhcyBnaXZlbiBhcyB0aGUgZmlyc3QgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhcmd1bWVudCBmb3IgbXVzdGFjaGUjcmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyknKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmYXVsdFdyaXRlci5yZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKTtcbiAgfTtcblxuICAvLyBUaGlzIGlzIGhlcmUgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggMC40LnguLFxuICAvKmVzbGludC1kaXNhYmxlICovIC8vIGVzbGludCB3YW50cyBjYW1lbCBjYXNlZCBmdW5jdGlvbiBuYW1lXG4gIG11c3RhY2hlLnRvX2h0bWwgPSBmdW5jdGlvbiB0b19odG1sICh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMsIHNlbmQpIHtcbiAgICAvKmVzbGludC1lbmFibGUqL1xuXG4gICAgdmFyIHJlc3VsdCA9IG11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMpO1xuXG4gICAgaWYgKGlzRnVuY3Rpb24oc2VuZCkpIHtcbiAgICAgIHNlbmQocmVzdWx0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH07XG5cbiAgLy8gRXhwb3J0IHRoZSBlc2NhcGluZyBmdW5jdGlvbiBzbyB0aGF0IHRoZSB1c2VyIG1heSBvdmVycmlkZSBpdC5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYW5sL211c3RhY2hlLmpzL2lzc3Vlcy8yNDRcbiAgbXVzdGFjaGUuZXNjYXBlID0gZXNjYXBlSHRtbDtcblxuICAvLyBFeHBvcnQgdGhlc2UgbWFpbmx5IGZvciB0ZXN0aW5nLCBidXQgYWxzbyBmb3IgYWR2YW5jZWQgdXNhZ2UuXG4gIG11c3RhY2hlLlNjYW5uZXIgPSBTY2FubmVyO1xuICBtdXN0YWNoZS5Db250ZXh0ID0gQ29udGV4dDtcbiAgbXVzdGFjaGUuV3JpdGVyID0gV3JpdGVyO1xuXG59KSk7XG5cbi8vICMjIFNpZGVLaXQgbmFtZXNwYWNlIFxuLy8gXG4vLyBUaGlzIGlzIHRoZSB0b3AgbGV2ZWwgbmFtZXNwYWNlIG9mIHRoZSBsaWJyYXJ5LiBcbihmdW5jdGlvbiAoU2lkZUtpdCwgJCkge1xuXG4gICAgLy8gKip2YXIgd2lkZ2V0cyoqXG4gICAgLy8gXG4gICAgLy8gV2lkZ2V0IGxpc3Qgb2YgcmVuZGVyZWQgcGx1Z2lucyB3aXRoIHRoZSBpbmZvcm1hdGlvbiByZXF1aXJlZCBmb3IgdGhlIHdpZGdldCBmYWN0b3J5XG4gICAgLy8gdG8gaW5pdGlhbGl6ZSBhbmQgY3JlYXRlIHRoZSB3aWRnZXRzIFxuICAgIHZhciB3aWRnZXRzID0gW107XG5cbiAgICAvLyAqKlNpZGVLaXQuaW5pdCgpKiogXG4gICAgLy9cbiAgICAvLyBJbml0aWFsaXplcyB0aGUgZnJhbWV3b3JrLiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHJpZ2h0IGFmdGVyIHlvdXIgZG9jdW1lbnQgXG4gICAgLy8gaGFzIGJlZW4gbG9hZGVkLiBGb3IgZXhhbXBsZTogXG4gICAgLy8gYGBganMgXG4gICAgLy8gJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICAvLyAgU2lkZUtpdC5pbml0KCk7ICAgIFxuICAgIC8vIH0pO1xuICAgIC8vIGBgYFxuICAgIFNpZGVLaXQuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdGlhbGl6ZVBhcnRpYWxTZWxlY3RvckV4cHJlc3Npb24oKTtcbiAgICAgICAgY29sbGVjdFdpZGdldHNDb25maWd1cmF0aW9uRGF0YSgpO1xuICAgICAgICB0aGlzLmZhY3RvcnkuY3JlYXRlKHdpZGdldHMpO1xuICAgICAgICB3aWRnZXRzID0gW107XG4gICAgfTtcblxuICAgIC8vICoqaW5pdGlhbGl6ZVBhcnRpYWxTZWxlY3RvckV4cHJlc3Npb24oKSoqIFxuICAgIC8vICBcbiAgICAvLyBDcmVhdGVzIGEganF1ZXJ5IGV4cHJlc3Npb24gdG8gYmUgYWJsZSB0byBzZWxlY3QgZWxlbWVudHMgd2l0aCBkYXRhIGF0dHJpYnV0ZXMgXG4gICAgLy8gc3VjaCBhcyBgZGF0YS1zaWRla2l0LSpgXG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVBhcnRpYWxTZWxlY3RvckV4cHJlc3Npb24oKSB7XG4gICAgICAgICQuZXhwclsnOiddLmhhc0F0dHIgPSAkLmV4cHIuY3JlYXRlUHNldWRvKGZ1bmN0aW9uIChyZWdleCkge1xuICAgICAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChyZWdleCk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IG9iai5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlLnRlc3QoYXR0cnNbaV0ubm9kZU5hbWUpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gKipjb2xsZWN0V2lkZ2V0c0NvbmZpZ3VyYXRpb25EYXRhKCkqKlxuICAgIC8vXG4gICAgLy8gQ29sbGVjdHMgYW5kIHBhcnNlIHRoZSBkYXRhIHJlcXVpcmVkIGZvciB3aWRnZXRzIGluaXRpYWxpemF0aW9uLlxuICAgIGZ1bmN0aW9uIGNvbGxlY3RXaWRnZXRzQ29uZmlndXJhdGlvbkRhdGEoKSB7XG4gICAgICAgICQoXCIqOmhhc0F0dHIoXmRhdGEtc2lkZWtpdC0uKyQpXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcGFyc2VXaWRnZXREYXRhKHRoaXMpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyAqKnBhcnNlV2lkZ2V0RGF0YSgpKiogXG4gICAgLy8gXG4gICAgLy8gUGFyc2VzIGNvbGxlY3RlZCBlbGVtZW50IHRvIGdldCB0aGUgY29uZmlndXJhdGlvbiBkYXRhIGZvciB0aGUgd2lkZ2V0J3MgaW5pdGlhbGl6YXRpb24gXG4gICAgZnVuY3Rpb24gcGFyc2VXaWRnZXREYXRhKGVsKSB7XG4gICAgICAgIHZhciBwcmVmaXggPSAnZGF0YS1zaWRla2l0LScsIGF0dHIsIG5hbWUsIHdpZGdldDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGFMZW4gPSBlbC5hdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IGFMZW47IGkrKykge1xuICAgICAgICAgICAgYXR0ciA9IGVsLmF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICBuYW1lID0gYXR0ci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAobmFtZS5pbmRleE9mKHByZWZpeCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAod2luZG93W2F0dHIudmFsdWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZGdldCA9IG5hbWUucmVwbGFjZShwcmVmaXgsICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLnB1c2goeyBpZDogZWwuaWQsIGRhdGE6IHdpbmRvd1thdHRyLnZhbHVlXSwgdzogd2lkZ2V0IH0pO1xuICAgICAgICAgICAgICAgICAgICAkKGVsKS5yZW1vdmVBdHRyKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IFwiU29tZXRoaW5nIHN0cmFuZ2UgaGFzIGhhcHBlbmVkLiBXaWRnZXQgJ1wiICsgYXR0ci5uYW1lICsgXCInIGRhdGEgbm90IGZvdW5kIVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKHdpbmRvdy5TaWRlS2l0ID0gd2luZG93LlNpZGVLaXQgfHwge30sIGpRdWVyeSk7XG52YXIgU2lkZUtpdCA9IHdpbmRvdy5TaWRlS2l0IHx8IHt9O1xuLy8gIyMgU2lkZUtpdC5mYWN0b3J5IG5hbWVzcGFjZSBcbi8vIFxuLy8gU3ViLW5hbWVzcGFjZSBvZiBTaWRlS2l0IHRoYXQgZW5jYXBzdWxhdGVzIHRoZSBmdW5jdGlvbmFsaXR5IHRvIGhhbmRsZSBcbi8vIHdpZGdldCBJbml0aWFsaXphdGlvbi4gXG5TaWRlS2l0LmZhY3RvcnkgPSB7fTtcblxuKGZ1bmN0aW9uIChGYWN0b3J5LCAkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gKipTaWRlS2l0LmZhY3RvcnkuY3JlYXRlKCkqKlxuICAgIC8vICBcbiAgICAvLyBJbml0aWFsaXplcyB0aGUgd2lkZ2V0cyBzcGVjaWZpZWQgb24gdGhlIGxpc3QuIFNpZGVLaXQuZmFjdG9yeSBob2xkcyBhIGxpc3RcbiAgICAvLyBvZiBhdmFpbGFibGUgd2lkZ2V0cyBhcyB0aGV5IHJlZ2lzdGVyIHRvIGl0cyBuYW1lc3BhY2UgZHluYW1pY2FsbHkgd2hlbiB0aGV5XG4gICAgLy8gYXJlIGluc2VydGVkIG9uIHRoZSBwYWdlLlxuICAgIC8vXG4gICAgLy8gLSBgcGFyYW0gT2JqZWN0W10gd2lkZ2V0c2AgLSBUaGUgbGlzdCBvZiBjb2xsZWN0ZWQgd2lkZ2V0IGNvbmZpZ3VyYXRpb24gb2JqZWN0cy4gIFxuICAgIEZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24gKHdpZGdldHMpIHtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIGNyZWF0ZVdpZGdldEZhY3RvcmlhbChpZHgsIHdpZGdldHMpO1xuICAgIH07XG5cbiAgICAvLyAqKmNyZWF0ZVdpZGdldEZhY3RvcmlhbCgpKipcbiAgICAvLyAgXG4gICAgLy8gSW5pdGlhbGl6ZXMgdGhlIHdpZGdldHMgc3BlY2lmaWVkIG9uIHRoZSBsaXN0LiBTaWRlS2l0LmZhY3RvcnkgaG9sZHMgYSBsaXN0XG4gICAgLy8gb2YgYXZhaWxhYmxlIHdpZGdldHMgYXMgdGhleSByZWdpc3RlciB0byBpdHMgbmFtZXNwYWNlIGR5bmFtaWNhbGx5IHdoZW4gdGhleVxuICAgIC8vIGFyZSBpbnNlcnRlZCBvbiB0aGUgcGFnZS4gIFxuICAgIC8vIFxuICAgIC8vIC0gYHBhcmFtIGludGVnZXIgaWR4IC0gVGhlIGN1cnJlbnQgaW5kZXhcbiAgICAvLyAtIGBwYXJhbSBPYmplY3RbXSB3aWRnZXRzYCAtIFRoZSBsaXN0IG9mIGNvbGxlY3RlZCB3aWRnZXQgY29uZmlndXJhdGlvbiBvYmplY3RzLiAgXG4gICAgZnVuY3Rpb24gY3JlYXRlV2lkZ2V0RmFjdG9yaWFsKGlkeCwgd2lkZ2V0cykge1xuICAgICAgICBpZiAoaWR4IDwgd2lkZ2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB3aWRnZXRzW2lkeF0sXG4gICAgICAgICAgICAgICAgbmFtZSA9IGNvbmZpZy53LFxuICAgICAgICAgICAgICAgIHc7XG5cbiAgICAgICAgICAgIGlmIChGYWN0b3J5Lmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdyA9IEZhY3RvcnlbbmFtZV07XG4gICAgICAgICAgICAgICAgJC53aGVuKHcuaW5pdChjb25maWcuZGF0YSkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB3LnJ1bihjb25maWcuaWQsIGNvbmZpZy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlV2lkZ2V0RmFjdG9yaWFsKCsraWR4LCB3aWRnZXRzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdpZGdldHMgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxufSkoU2lkZUtpdC5mYWN0b3J5LCBqUXVlcnkpO1xudmFyIFNpZGVLaXQgPSB3aW5kb3cuU2lkZUtpdCB8fCB7fTtcbi8vICMjIFNpZGVLaXQud2lkZ2V0IG5hbWVzcGFjZSBcbi8vIFxuLy8gU3ViLW5hbWVzcGFjZSBvZiBTaWRlS2l0IHRoYXQgcHJvdmlkZXMgY29tbW9uIGZ1bmNpb25hbGl0eSBmb3IgdGhlIHdpZGdldHMuXG5TaWRlS2l0LndpZGdldCA9IHt9O1xuXG4oZnVuY3Rpb24gKFdpZGdldCwgJCwgTXVzdGFjaGUsIHVuZGVmaW5lZCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyAqKlNpZGVLaXQud2lkZ2V0LmVudioqIFxuICAgIC8vIFxuICAgIC8vIEN1cnJlbnQgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnRcbiAgICBXaWRnZXQuZW52ID0gJ0RFVic7XG4gICAgLy8gKipTaWRlS2l0LndpZGdldC5hc3NldHNQYXRoKiogXG4gICAgLy8gXG4gICAgLy8gVGhlIHBhdGggd2hlcmUgdGhlIHZlbmRvciBmaWxlcyBhcmUgbG9jYXRlZC4gSWYgYGNkbkpzYCBpcyBzcGVjaWZpZWQsIHRoZSB3aWRnZXQgXG4gICAgLy8gd2lsbCBsb2FkIHRoZSBjb3JyZXNwb25kZW50IHNjcmlwdHMgZHluYW1pY2FsbHkgZnJvbSBpdHMgY2RuIHNvdXJjZS5cbiAgICBXaWRnZXQuYXNzZXRzUGF0aCA9IG51bGw7XG5cbiAgICAvLyAqKlNpZGVLaXQud2lkZ2V0LmdldFN0eWxlU2hlZXQoKSoqXG4gICAgLy8gIFxuICAgIC8vIEluamVjdHMgYSBzdHlsZXNoZWV0IGludG8gdGhlIGN1cnJlbnQgZG9jdW1lbnRcbiAgICAvL1xuICAgIC8vIC0gYHBhcmFtIHN0cmluZyB1cmxgIC0gVGhlIGxpc3Qgb2YgY29sbGVjdGVkIHdpZGdldCBjb25maWd1cmF0aW9uIG9iamVjdHMuICBcbiAgICBXaWRnZXQuZ2V0U3R5bGVTaGVldCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgJGQgPSAkLkRlZmVycmVkKCk7XG4gICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG4gICAgICAgIGxpbmsudHlwZSA9IFwidGV4dC9jc3NcIjtcbiAgICAgICAgbGluay5yZWwgPSBcInN0eWxlc2hlZXRcIjtcbiAgICAgICAgbGluay5ocmVmID0gdXJsO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQobGluayk7XG4gICAgICAgICRkLnJlc29sdmUobGluayk7XG4gICAgICAgIHJldHVybiAkZC5wcm9taXNlKCk7XG4gICAgfTtcblxuICAgIC8vICoqU2lkZUtpdC53aWRnZXQuZ2V0TWFpblNpZGVLaXRTY3JpcHRUYWcoKSoqXG4gICAgLy8gIFxuICAgIC8vIFJldHVybnMgdGhlIHNjcmlwdCB0YWcgdGhhdCBsb2FkcyB0aGUgbGlicmFyeVxuICAgIFdpZGdldC5nZXRNYWluU2lkZUtpdFNjcmlwdFRhZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmN1cnJlbnRTY3JpcHQpIHtcbiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYztcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc2NyaXB0c1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2lkZWtpdCcpKSB7XG4gICAgICAgICAgICAgICAgV2lkZ2V0LmVudiA9IHNjcmlwdHNbaV0uc3JjLm1hdGNoKC9zaWRla2l0LWNvcmUubWluLmpzfHNpZGVraXQtY29yZS5qcy8pID8gJ1BST0QnIDogJ0VOVic7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuICAgIC8vICoqU2lkZUtpdC53aWRnZXQuZ2V0QXNzZXRzUGF0aCgpKipcbiAgICAvLyAgXG4gICAgLy8gUmV0dXJucyB0aGUgdmVuZG9yIGFzc2V0cyBwYXRoLiBJdHMgdGhlIHZhbHVlIGNvbmZpZ3VyZWQgaW4gdGhlIGBkYXRhLXNpZGVraXRgIGF0dHJpYnV0ZSBcbiAgICAvLyBvZiB0aGUgc2NyaXB0IHRhZyB0aGF0IGxvYWRzIHRoZSBsaWJyYXJ5LiAgXG4gICAgV2lkZ2V0LmdldEFzc2V0c1BhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmFzc2V0c1BhdGggPT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBzY3JpcHQgPSB0aGlzLmdldE1haW5TaWRlS2l0U2NyaXB0VGFnKCk7XG4gICAgICAgICAgICB0aGlzLmFzc2V0c1BhdGggPSBzY3JpcHQuZ2V0QXR0cmlidXRlKCdkYXRhLXNpZGVraXQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hc3NldHNQYXRoO1xuICAgIH07XG5cbiAgICAvLyAqKlNpZGVLaXQud2lkZ2V0LnJlbmRlcigpKipcbiAgICAvLyAgXG4gICAgLy8gUmVuZGVycyB0aGUgd2lkZ2V0IHRvIHRoZSBkb2N1bWVudC4gXG4gICAgLy9cbiAgICAvLyAtIGBwYXJhbSBqUXVlcnkgT2JqZWN0ICRlbCAtIFRoZSBlbGVtZW50IHRvIHJlbmRlciB0aGUgY29udGVudHNcbiAgICAvLyAtIGBwYXJhbSBzdHJpbmcgdGVtcGxhdGVgIC0gVGhlIG11c3RhY2hlIHN0cmluZyB0ZW1wbGF0ZSB0byByZW5kZXIgdGhlIHdpZGdldCBcbiAgICAvLyAtIGBwYXJhbSBPYmplY3QgZGF0YWAgLSBUaGUgbXVzdGFjaGUgZGF0YSB0byB0cmFuc2Zvcm0gdGhlIHRlbXBsYXRlXG4gICAgV2lkZ2V0LnJlbmRlciA9IGZ1bmN0aW9uICgkZWwsIHRlbXBsYXRlLCBkYXRhKSB7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG4gICAgICAgIGlmICh0ZW1wbGF0ZSAhPT0gdW5kZWZpbmVkICYmIHRlbXBsYXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBodG1sID0gTXVzdGFjaGUudG9faHRtbCh0ZW1wbGF0ZSwgZGF0YSB8fCDCoHt9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKF9fZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBodG1sID0gX19lcnJvci50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRlbC5odG1sKGh0bWwpO1xuICAgIH07XG59KShTaWRlS2l0LndpZGdldCwgalF1ZXJ5LCBNdXN0YWNoZSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
